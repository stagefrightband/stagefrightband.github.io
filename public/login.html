<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="noindex,nofollow" />
    <meta
      name="googlebot-news"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Stage Fright Band Website" />
    <link rel="canonical" href="https://stagefrightband.github.io" />
    <link rel="stylesheet" href="CSS/login.css" />
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2.46.2/dist/umd/supabase.js"></script>
    <script src="%PUBLIC_URL%/static/js/main.js"></script>
    <script>
      // Function to get a cookie by name
      function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(";").shift();
        return null;
      }

      // Function to apply or remove a class based on cookie value
      function toggleClassBasedOnCookie(cookieName, className) {
        const cookieValue = getCookie(cookieName) === "true";
        if (cookieValue) {
          document.documentElement.classList.add(className);
        } else {
          document.documentElement.classList.remove(className);
        }
      }

      // Check and apply the classes based on the cookies
      toggleClassBasedOnCookie("highcontrast", "high-contrast");
      toggleClassBasedOnCookie("opendyslexic", "open-dyslexic");

      // Optional: If you want to monitor changes in the cookies dynamically
      setInterval(() => {
        toggleClassBasedOnCookie("highcontrast", "high-contrast");
        toggleClassBasedOnCookie("opendyslexic", "open-dyslexic");
      }, 1000);

      const { useState, useEffect } = React;
      const { createClient } = supabase;
      const { Auth } = supabaseAuthUiReact;
      const { ThemeSupa } = supabaseAuthUiShared;

      const supabaseUrl = process.env.REACT_APP_SUPABASE_URL;
      const supabaseAnonKey = process.env.REACT_APP_ANON_KEY;
      const supabase = createClient(supabaseUrl, supabaseAnonKey);

      function Login() {
        const [session, setSession] = useState(null);

        useEffect(() => {
          supabase.auth.getSession().then(({ data: { session } }) => {
            setSession(session);
          });

          const {
            data: { subscription },
          } = supabase.auth.onAuthStateChange((_event, session) => {
            setSession(session);
          });

          return () => subscription.unsubscribe();
        }, []);

        if (!session) {
          return (
            <Auth supabaseClient={supabase} appearance={{ theme: ThemeSupa }} />
          );
        } else {
          return <div>Logged in!</div>;
        }
      }

      const rootElement = document.getElementById("login-root");
      if (rootElement) {
        const root = ReactDOM.createRoot(rootElement);
        root.render(
          <React.StrictMode>
            <Login />
          </React.StrictMode>
        );
      }
    </script>
    <title>Login - Stage Fright</title>

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="Images/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="Images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="Images/favicon-16x16.png"
    />
    <link rel="icon" type="image/x-icon" href="Images/favicon.ico" />
    <link rel="manifest" href="site.webmanifest" />
  </head>

  <!-- Login icon obtained from https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.vecteezy.com%2Ffree-vector%2Flogin-icon&psig=AOvVaw1gsnfXABASMBCw_0OsnoO7&ust=1731690198618000&source=images&cd=vfe&opi=89978449&ved=0CBEQjRxqFwoTCOCU2eqm3IkDFQAAAAAdAAAAABAE-->

  <body>
    <div class="topnav">
      <a class="logo" href="index.html"
        ><img
          src="Images/Main logo fright.png"
          alt="Stage Fright Logo"
          width="10.434vh"
          class="logoimage"
      /></a>
      <a href="aboutus.html">About Us</a>
      <a href="contactus.html">Contact Us</a>
      <a href="store.html">Store</a>
      <a href="tourdates.html">Tour Dates</a>
      <a href="login.html">
        <img
          alt="Login Icon"
          style="width: 6.26vh; height: 6.26vh"
          src="Images/login-icon.png"
        />
      </a>
      <a href="shoppingcart.html">
        <img
          alt="Shopping Cart Icon"
          style="width: 6.26vh; height: 6.26vh"
          src="Images/shoppingcart.png"
        />
      </a>
      <a href="settings.html">
        <img
          alt="Accessibility Settings"
          style="width: 6.26vh; height: 6.26vh"
          src="Images/accessibilityicon.png"
        />
      </a>
    </div>
    <div id="login-root"></div>
  </body>
</html>
